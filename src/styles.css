/**
 * @file Global Styles
 * @description Styles globaux de l'application Bassenge Pneu.
 * Utilise Tailwind CSS avec des composants personnalisés.
 */

@import 'ngx-toastr/toastr';
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═══════════════════════════════════════════════════════════════════════════
   BASE STYLES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer base {
  html {
    scroll-behavior: smooth;
  }

  html, body {
    @apply bg-brand-dark text-slate-100 antialiased;
  }

  /* Focus visible amélioré pour l'accessibilité */
  :focus-visible {
    @apply outline-none ring-2 ring-sky-500/50 ring-offset-2 ring-offset-brand-dark;
  }

  /* Scrollbar personnalisée */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-slate-800/50 rounded-full;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-slate-600 rounded-full hover:bg-slate-500 transition-colors;
  }

  /* Sélection de texte */
  ::selection {
    @apply bg-brand-red/30 text-white;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   ANIMATIONS
   ═══════════════════════════════════════════════════════════════════════════ */

@layer utilities {
  /* Fade in */
  .animate-fade-in {
    animation: fadeIn 0.3s ease-out forwards;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Slide in from bottom */
  .animate-slide-up {
    animation: slideUp 0.3s ease-out forwards;
  }

  @keyframes slideUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Scale in (pour les modales) */
  .animate-scale-in {
    animation: scaleIn 0.2s ease-out forwards;
  }

  @keyframes scaleIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }

  /* Pulse subtil pour attirer l'attention */
  .animate-pulse-soft {
    animation: pulseSoft 2s ease-in-out infinite;
  }

  @keyframes pulseSoft {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  /* Shimmer pour les skeletons */
  .animate-shimmer {
    background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.08) 50%, transparent 100%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
  }

  @keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   BOUTONS
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  /* Bouton primaire (rouge) */
  .btn-primary {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl
           font-medium text-white bg-brand-red hover:brightness-110 active:brightness-95
           transition-all duration-200 active:scale-[0.98];
  }

  /* Bouton CTA avec effet skew */
  .btn-cta {
    @apply inline-flex items-center gap-2 px-4 py-2.5 font-semibold text-white
           bg-brand-red rounded-xl shadow-soft transition-all duration-200
           hover:shadow-lg hover:shadow-brand-red/20 active:scale-[0.98];
    transform: skewX(-12deg);
  }
  .btn-cta > * { transform: skewX(12deg); }

  /* Bouton secondaire */
  .btn-secondary {
    @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-lg
           bg-white/5 text-slate-200 hover:bg-white/10
           border border-white/10 hover:border-white/20
           transition-all duration-200 active:scale-[0.98];
  }

  /* Bouton danger (rouge outline) */
  .btn-danger-outline {
    @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-lg
           border border-red-500/40 text-red-400
           hover:bg-red-500/10 hover:border-red-500/60
           transition-all duration-200 active:scale-[0.98];
  }

  /* Bouton warning (orange outline) */
  .btn-warning-outline {
    @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-lg
           border border-amber-500/40 text-amber-400
           hover:bg-amber-500/10 hover:border-amber-500/60
           transition-all duration-200 active:scale-[0.98];
  }

  /* Bouton success (vert outline) */
  .btn-success-outline {
    @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-lg
           border border-emerald-500/40 text-emerald-400
           hover:bg-emerald-500/10 hover:border-emerald-500/60
           transition-all duration-200 active:scale-[0.98];
  }

  /* Bouton icon only */
  .btn-icon {
    @apply p-2 rounded-lg bg-white/5 text-slate-300
           hover:bg-white/10 hover:text-white
           border border-white/10 hover:border-white/20
           transition-all duration-200 active:scale-[0.95];
  }

  /* Bouton flottant (FAB) */
  .btn-fab {
    @apply fixed bottom-6 right-6 z-40
           w-14 h-14 rounded-full
           bg-brand-red text-white
           shadow-lg shadow-brand-red/30
           flex items-center justify-center
           hover:scale-110 hover:shadow-xl hover:shadow-brand-red/40
           transition-all duration-200 active:scale-100;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   NAVIGATION
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .nav-link {
    @apply flex items-center gap-3 px-3 py-2.5 rounded-xl text-slate-300
           hover:text-white hover:bg-white/10
           transition-all duration-200;
  }

  .nav-link-active {
    @apply bg-white/10 text-white shadow-sm;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   CARTES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .card {
    @apply bg-white text-slate-800 border border-slate-200 rounded-2xl shadow-soft;
  }

  .card-dark {
    @apply bg-brand-mid/60 backdrop-blur border border-white/10 rounded-2xl shadow-soft
           transition-all duration-200;
  }

  .card-dark:hover {
    @apply border-white/15;
  }

  /* Card interactive */
  .card-interactive {
    @apply card-dark cursor-pointer hover:bg-brand-mid/80;
  }

  /* Card avec indicateur de statut */
  .card-status {
    @apply card-dark relative overflow-hidden;
  }

  .card-status::before {
    @apply absolute left-0 top-0 bottom-0 w-1 bg-slate-600;
    content: '';
  }

  .card-status-success::before { @apply bg-emerald-500; }
  .card-status-warning::before { @apply bg-amber-500; }
  .card-status-danger::before { @apply bg-red-500; }
  .card-status-info::before { @apply bg-sky-500; }
}

/* ═══════════════════════════════════════════════════════════════════════════
   INPUTS & FORMULAIRES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .input-brand {
    @apply w-full rounded-xl border border-white/10 bg-white/5 text-white
           placeholder:text-slate-400 px-10 py-2.5
           focus:outline-none focus:ring-2 focus:ring-brand-red/40 focus:border-brand-red/30
           transition-all duration-200;
  }

  .input-ghost {
    @apply w-full rounded-xl border border-white/10 bg-white/5 text-white
           placeholder:text-slate-400 px-4 py-2.5
           focus:outline-none focus:ring-2 focus:ring-brand-red/40 focus:border-brand-red/30
           transition-all duration-200;
  }

  /* Champ avec icône à gauche */
  .field {
    @apply relative;
  }

  .field-icon {
    @apply pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400;
  }

  .field-input {
    @apply input-brand pl-10 h-11;
  }

  .field-input-ghost {
    @apply input-ghost pl-10 h-11;
  }

  .field-input-compact {
    @apply input-brand pl-4 h-11;
  }

  /* Label de formulaire */
  .form-label {
    @apply block text-sm font-medium text-slate-300 mb-1.5;
  }

  /* Message d'erreur */
  .form-error {
    @apply text-xs text-red-400 mt-1 flex items-center gap-1;
  }

  /* Groupe de formulaire */
  .form-group {
    @apply space-y-1;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   BADGES & CHIPS
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .badge-count {
    @apply inline-flex items-center gap-1 text-xs px-2.5 py-1 rounded-full
           bg-white/10 text-white border border-white/10
           font-medium;
  }

  .chip {
    @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs
           bg-white/10 text-white font-medium;
  }

  /* Variantes de chips */
  .chip-success {
    @apply bg-emerald-500/20 text-emerald-300 border border-emerald-500/30;
  }

  .chip-warning {
    @apply bg-amber-500/20 text-amber-300 border border-amber-500/30;
  }

  .chip-danger {
    @apply bg-red-500/20 text-red-300 border border-red-500/30;
  }

  .chip-info {
    @apply bg-sky-500/20 text-sky-300 border border-sky-500/30;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   SKELETON LOADERS
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .skeleton {
    @apply bg-slate-700/50 rounded animate-shimmer;
  }

  .skeleton-text {
    @apply skeleton h-4 rounded;
  }

  .skeleton-text-lg {
    @apply skeleton h-6 rounded;
  }

  .skeleton-avatar {
    @apply skeleton w-10 h-10 rounded-full;
  }

  .skeleton-button {
    @apply skeleton h-10 w-24 rounded-xl;
  }

  .skeleton-card {
    @apply skeleton h-32 w-full rounded-2xl;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   TOOLTIPS
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  [data-tooltip] {
    @apply relative;
  }

  [data-tooltip]::after {
    content: attr(data-tooltip);
    @apply absolute bottom-full left-1/2 -translate-x-1/2 mb-2
           px-2 py-1 rounded text-xs font-medium
           bg-slate-800 text-white border border-white/10
           opacity-0 invisible transition-all duration-200
           whitespace-nowrap z-50 pointer-events-none;
  }

  [data-tooltip]:hover::after {
    @apply opacity-100 visible;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   STATS CARDS
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .stat-card {
    @apply card-dark p-4 flex items-center gap-4;
  }

  .stat-icon {
    @apply w-12 h-12 rounded-xl flex items-center justify-center
           bg-white/5 text-slate-300;
  }

  .stat-value {
    @apply text-2xl font-bold text-white;
  }

  .stat-label {
    @apply text-sm text-slate-400;
  }

  /* Variantes */
  .stat-card-success .stat-icon { @apply bg-emerald-500/20 text-emerald-400; }
  .stat-card-warning .stat-icon { @apply bg-amber-500/20 text-amber-400; }
  .stat-card-danger .stat-icon { @apply bg-red-500/20 text-red-400; }
  .stat-card-info .stat-icon { @apply bg-sky-500/20 text-sky-400; }
}

/* ═══════════════════════════════════════════════════════════════════════════
   EMPTY STATES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .empty-state {
    @apply card-dark p-10 text-center;
  }

  .empty-state-icon {
    @apply inline-flex items-center justify-center w-16 h-16 rounded-full
           bg-slate-700/50 mb-4 mx-auto;
  }

  .empty-state-title {
    @apply text-xl font-semibold mb-2;
  }

  .empty-state-text {
    @apply text-slate-400 text-sm max-w-md mx-auto;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   MODALES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .modal-overlay {
    @apply fixed inset-0 z-50 bg-black/60 backdrop-blur-sm;
  }

  .modal-content {
    @apply relative w-full max-w-lg mx-4 animate-scale-in;
  }

  .modal-header {
    @apply flex items-center justify-between gap-4 mb-4;
  }

  .modal-title {
    @apply text-lg font-semibold;
  }

  .modal-body {
    @apply space-y-4;
  }

  .modal-footer {
    @apply flex justify-end gap-3 mt-6 pt-4 border-t border-white/10;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   TABLES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .table-container {
    @apply card-dark overflow-hidden;
  }

  .table-header {
    @apply bg-white/5 px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider;
  }

  .table-row {
    @apply border-b border-white/5 hover:bg-white/[.02] transition;
  }

  .table-cell {
    @apply px-4 py-3 text-sm;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   RESPONSIVE UTILITIES
   ═══════════════════════════════════════════════════════════════════════════ */

@layer utilities {
  /* Hide on small screens */
  .hide-mobile {
    @apply hidden sm:flex;
  }

  /* Hide on large screens */
  .hide-desktop {
    @apply flex sm:hidden;
  }

  /* Truncate text with ellipsis */
  .text-truncate {
    @apply truncate;
  }

  /* Line clamp */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   ICÔNES
   ═══════════════════════════════════════════════════════════════════════════ */

button svg[aria-hidden="true"] {
  margin-right: 0.5rem;
  vertical-align: middle;
}

button svg {
  width: 16px;
  height: 16px;
}

/* ═══════════════════════════════════════════════════════════════════════════
   RESPONSIVE ADJUSTMENTS
   ═══════════════════════════════════════════════════════════════════════════ */

@media (max-width: 640px) {
  .field-icon {
    left: 0.6rem;
  }

  .field-input,
  .field-input-ghost {
    padding-left: 2.2rem;
  }

  /* Boutons plus petits sur mobile */
  .btn-cta,
  .btn-primary {
    @apply px-3 py-2 text-sm;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   PRINT STYLES
   ═══════════════════════════════════════════════════════════════════════════ */

@media print {
  body {
    @apply bg-white text-black;
  }

  .card-dark {
    @apply bg-white border-gray-200 shadow-none;
  }

  .btn-cta,
  .btn-fab,
  nav {
    display: none !important;
  }
}
